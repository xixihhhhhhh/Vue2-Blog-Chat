<template>
  <div class="personMsg">
    <div>
      <img :src="imgurl+'#xxx'" @click="editAvatarFlag = true">
      <div @click="editAvatarFlag = true">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665903161826"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="3064" width="20" height="20">
          <path
            d="M236.352009 923.205363l-2.865257 0.76748 463.946564 0c11.307533 0 20.466124 9.15859 20.466124 20.466124 0 11.2973-9.15859 20.466124-20.466124 20.466124L78.220502 964.90509c-0.010233 0-0.010233 0-0.020466 0-0.347924 0-0.685615-0.010233-1.033539-0.030699-0.143263 0-0.276293-0.010233-0.419556-0.030699-0.409322-0.020466-0.828878-0.061398-1.238201-0.122797-0.76748-0.092098-1.524726-0.23536-2.261507-0.429789-0.306992-0.081864-0.624217-0.163729-0.931209-0.255827-0.23536-0.071631-0.480954-0.143263-0.716314-0.225127-0.23536-0.081864-0.470721-0.173962-0.695848-0.255827 0 0 0 0-0.010233 0-0.225127-0.092098-0.460488-0.184195-0.685615-0.286526-0.23536-0.092098-0.460488-0.194428-0.685615-0.306992-0.296759-0.143263-0.593518-0.286526-0.890276-0.450255-0.296759-0.153496-0.593518-0.317225-0.880043-0.491187-0.583285-0.337691-1.146103-0.716314-1.678222-1.115404-0.225127-0.163729-0.440022-0.327458-0.654916-0.50142-1.166569-0.931209-2.230808-1.995447-3.162016-3.162016-0.173962-0.214894-0.337691-0.429789-0.50142-0.654916-0.613984-0.818645-1.156336-1.688455-1.63729-2.609431-0.143263-0.276293-0.286526-0.562818-0.419556-0.839111-0.102331-0.225127-0.204661-0.450255-0.306992-0.685615-0.194428-0.460488-0.36839-0.920976-0.532119-1.391696-0.153496-0.470721-0.296759-0.941442-0.429789-1.412163-0.184195-0.73678-0.337691-1.473561-0.450255-2.220574-0.092098-0.63445-0.153496-1.289366-0.194428-1.934049 0-0.020466-0.010233-0.030699 0-0.051165-0.010233-0.153496-0.010233-0.306992-0.010233-0.460488-0.010233-0.081864-0.010233-0.173962-0.010233-0.26606-0.010233-0.306992 0-0.624217 0.010233-0.941442 0.010233-0.225127 0.020466-0.440022 0.030699-0.665149 0.040932-0.665149 0.122797-1.330298 0.225127-1.995447 0.030699-0.225127 0.071631-0.440022 0.122797-0.654916 0.040932-0.225127 0.092098-0.440022 0.143263-0.665149 0.051165-0.214894 0.102331-0.440022 0.163729-0.654916l0.153496-0.562818c0.010233-0.081864 0.040932-0.153496 0.061398-0.225127l40.768519-152.032602c0.941442-3.50994 2.793626-6.692423 5.372358-9.250688l633.426537-626.928542c8.032954-7.951089 20.998243-7.889691 28.949332 0.143263 7.951089 8.043187 7.879458 20.998243-0.153496 28.949332l-629.486808 623.039979-30.371728 113.208365 113.320928-30.402427 629.568672-623.121843c8.032954-7.951089 20.998243-7.879458 28.949332 0.153496 7.951089 8.032954 7.879458 20.98801-0.153496 28.939099l-633.426537 626.938776C242.911402 920.483368 239.780085 922.284387 236.352009 923.205363z"
            p-id="3065" fill="#1296db" />
          <path
            d="M921.621285 247.977791c-0.100284 0.079818 16.818037-16.838503 16.818037-16.838503 38.797631-38.797631 38.797631-101.685937 0.040932-140.453892-38.836517-38.807864-101.706403-38.777165-140.484591 0 0 0-16.935718 16.937764-16.838503 16.838503L921.621285 247.977791z"
            p-id="3066" fill="#1296db" />
          <path
            d="M57.774845 943.773817c-0.010233 0.317225-0.020466 0.63445-0.010233 0.941442-0.010233-0.092098-0.010233-0.184195-0.010233-0.276293C57.754379 944.213839 57.754379 943.988712 57.774845 943.773817z"
            p-id="3067" fill="#1296db" />
          <path
            d="M58.030671 941.113221c-0.102331 0.665149-0.184195 1.330298-0.225127 1.995447C57.836243 942.433286 57.918108 941.768137 58.030671 941.113221z"
            p-id="3068" fill="#1296db" />
          <path
            d="M57.979506 947.42702c-0.102331-0.63445-0.163729-1.279133-0.194428-1.934049C57.82601 946.137655 57.887408 946.792571 57.979506 947.42702z"
            p-id="3069" fill="#1296db" />
          <path
            d="M58.613956 938.575422c-0.122797 0.399089-0.23536 0.808412-0.317225 1.217734 0.051165-0.214894 0.102331-0.440022 0.163729-0.654916L58.613956 938.575422z"
            p-id="3070" fill="#1296db" />
        </svg>change your avatar
      </div>
    </div>

    <div v-if="editFlag" class="editPMsg">
      <div>
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665851187621"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="6978" width="20" height="20">
          <path
            d="M492.642454 544.492238c138.576752 0 250.922119-112.345367 250.922119-250.924119 0-138.576752-112.344367-250.922119-250.922119-250.922119-138.578752 0-250.924119 112.345367-250.924119 250.923119 0 138.577752 112.345367 250.923119 250.924119 250.923119m329.666273 152.226433C763.454107 634.645126 743.657571 613.336625 635.847097 607.485762H349.42681c-107.810473 5.851863-127.607009 27.159363-186.461629 89.231909-62.510535 64.169496-112.295368 145.404592-88.694922 246.144231 26.184386 65.876456 96.935728 81.138098 163.83616 81.138098h509.062069c66.899432 0 137.699773-15.261642 163.885159-81.138098 23.599447-100.739639-26.185386-181.974735-88.74492-246.144231"
            p-id="6979" />
        </svg>
        <div>
          <el-input placeholder="Name" v-model="Name"></el-input>
        </div>
      </div>

      <div>
        <svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
          <path fill-rule="evenodd"
            d="M11.536 3.464a5 5 0 010 7.072L8 14.07l-3.536-3.535a5 5 0 117.072-7.072v.001zm1.06 8.132a6.5 6.5 0 10-9.192 0l3.535 3.536a1.5 1.5 0 002.122 0l3.535-3.536zM8 9a2 2 0 100-4 2 2 0 000 4z">
          </path>
        </svg>
        <div>
          <el-input placeholder="Location" v-model="Address"></el-input>
        </div>
      </div>

      <div>
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665840042361"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="2544" width="20" height="20">
          <path
            d="M874.666667 375.189333V746.666667a64 64 0 0 1-64 64H213.333333a64 64 0 0 1-64-64V375.189333l64 54.250667V746.666667h597.333334V429.44l64-54.250667zM810.666667 213.333333a64.789333 64.789333 0 0 1 22.826666 4.181334 63.616 63.616 0 0 1 26.794667 19.413333 64.32 64.32 0 0 1 9.344 15.466667c2.773333 6.570667 4.48 13.696 4.906667 21.184L874.666667 277.333333v21.333334L553.536 572.586667a64 64 0 0 1-79.893333 2.538666l-3.178667-2.56L149.333333 298.666667v-21.333334a63.786667 63.786667 0 0 1 35.136-57.130666A63.872 63.872 0 0 1 213.333333 213.333333h597.333334z m-9.6 64h-578.133334L512 523.882667 801.066667 277.333333z"
            p-id="2545" />
        </svg>
        <div>
          <el-input placeholder="Email" v-model="Email"></el-input>
        </div>
      </div>

      <div>
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665843209019"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="3899" width="22" height="22">
          <path
            d="M771.616 503.798c2.176 2.021 4.392 3.535 6.839 3.837l12.339 1.522-7.739-9.506c-1.422-2.823-2.318-16.482-3.041-27.477-0.941-14.344-2.009-30.602-4.636-42.272-6.038-26.828-16.197-49.977-29.378-66.946-7.159-9.217-15.027-16.305-23.379-21.151-7.762-10.119-26.715-25.858-31.931-26.946-5.083-1.06-15.044 2.573-19.978 5.958-7.348-6.753-15.332-13.002-19.488-12.54-4.588 0.51-11.2 4.658-15.054 8.533-31.478-78.994-53.626-108.336-104.876-133.431a21.45 21.45 0 0 0 7.311-3.173c7.309-4.952 11.752-11.386 13.206-19.125 2.026-10.785-1.849-23.363-11.519-37.383-8.242-11.95-19.426-18.531-31.49-18.531-7.104 0-14.073 2.313-20.154 6.69-2.517 1.812-4.809 4.129-6.891 6.98a33.615 33.615 0 0 0-1.948-4.29c-2.594-4.792-8.06-10.503-19.366-10.503-8.579 0-19.537 3.366-32.567 10.006-15.55 7.923-24.961 19.081-25.822 30.612-0.587 7.872 2.973 14.98 10.025 20.017 0.292 0.208 0.587 0.416 0.885 0.621-7.735 2.512-16.689 6.918-21.82 14.516-4.031 5.97-5.104 12.858-3.187 20.473 5.035 20.01 25.733 36.915 45.197 36.915 0.874 0 1.749-0.035 2.601-0.104 8.585-0.694 13.815-3.873 17.376-8.387 1.095 2.526 2.528 4.813 4.286 6.804 4.815 5.453 11.681 8.336 19.855 8.336 7.579 0 16.051-2.464 25.181-7.324 26.65-14.184 32.266-28.321 32.285-37.682a23.562 23.562 0 0 0-0.174-2.875c49.204 29.338 83.479 83.419 103.896 170.933 2.541 1.42 5.744 0.746 8.362-0.978-1.567 4.68-2.875 9.922-4.023 15.639-20.258-13.446-11.28-34.159-14.207-36.702-3.19-2.771-11.404 12.466-6.231 32.871 2.001 7.893 10.442 21.877 16.614 27.736-0.596 4.434-1.181 9.018-1.782 13.735-2.397 18.828-4.877 38.297-9.299 57.27-5.848 25.085-29.132 44.79-53.784 65.652-26.023 22.023-52.809 44.689-59.785 75.444-19.43-32.724-48.546-74.604-86.527-109.439-45.233-41.487-91.783-62.523-138.356-62.523-6.658 0-13.396 0.441-20.03 1.311-36.631 4.805-65.279 20.393-85.149 46.332-17.364 22.667-27.69 52.722-30.69 89.33-2.631 32.094 10.039 70.793 37.656 115.022 20.375 32.63 41.172 55.654 42.048 56.619l8.121 8.945 1.254-26.339c12.57 12.844 37.936 38.725 61.842 62.887 44.155 44.629 185.458 110.35 191.452 113.126l5.334 2.471 0.286-1.023-0.033 14.779 7.7-4.888c13.792-8.754 135.143-86.155 149.068-107.991 9.204-14.432 33.555-81.619 57.104-146.595 12.493-34.469 24.293-67.026 32.819-88.871 1.464-3.752 2.72-6.691 3.828-9.284 3.223-7.544 5.109-11.96 6.08-22.297 3.559 3.624 4.997 4.574 6.718 4.932l8.461 1.758-2.693-8.212c-1.881-5.731-0.621-22.085 0.299-34.026 0.297-3.861 0.533-7.084 0.699-9.798z m-273.86-276.096c-7.669 4.081-14.56 6.151-20.483 6.151-5.298 0-9.456-1.667-12.359-4.955-3.578-4.053-5.037-10.388-4.107-17.838a5 5 0 0 0-9.729-2.128c-4.378 13.83-6.534 17.424-16.129 18.199-0.585 0.047-1.189 0.071-1.795 0.071-13.297 0-31.146-12.056-35.5-29.355-1.209-4.806-0.628-8.874 1.777-12.436 5.129-7.597 17.684-11.776 27.722-13.155a5 5 0 0 0 1.522-9.443c-4.358-2.138-7.785-4.132-10.785-6.274-4.218-3.013-6.191-6.759-5.865-11.135 0.585-7.848 8.208-16.239 20.39-22.446 11.611-5.917 21.041-8.916 28.027-8.916 6.922 0 9.349 3.004 10.572 5.264 2.699 4.985 3.496 10.802 2.367 17.291a5 5 0 0 0 9.681 2.402c3.04-9.356 6.884-15.758 11.427-19.028 4.369-3.145 9.318-4.807 14.312-4.807 8.678 0 16.938 5.046 23.257 14.209 7.986 11.579 11.418 21.904 9.923 29.859-0.957 5.092-3.896 9.244-8.987 12.692-2.017 1.367-4.274 2.031-6.899 2.031h-0.001c-3.697 0-7.459-1.334-10.205-2.309-1.108-0.393-2.065-0.732-2.959-0.977a4.996 4.996 0 0 0-5.961 2.97 5 5 0 0 0 2.277 6.258c7.077 3.802 15.51 10.172 15.493 18.928-0.018 9.371-9.6 19.626-26.983 28.877z m190.636 100.023c1.403 0.758 3.818 3.512 6.111 6.399a54.611 54.611 0 0 0-9.431 0.93c-1.88-1.939-5.179-5.393-9.065-9.201 3.74-0.25 8.172-0.405 12.385 1.872z m-37.545 27.467c-4.272-11.528-8.319-22.208-12.215-32.146 3.412-1.127 7.833-2.991 12.821-0.296 2.765 1.494 12.275 14.878 15.07 18.867a84.21 84.21 0 0 0-5.477 3.112c-4.018 2.489-7.239 6.244-9.891 11.053-0.09-0.2-0.192-0.396-0.308-0.59z m117.447 131.892l-15.424-6.89 8.901 13.731c0.435 2.538-0.262 11.582-0.825 18.901-0.697 9.05-1.243 16.894-1.303 23.346-1.62-1.737-2.291-2.414-2.92-2.87l-7.653-5.55-0.28 9.449c-0.522 17.645-1.886 20.836-5.934 30.31-1.137 2.661-2.426 5.678-3.948 9.576-8.57 21.959-20.391 54.572-32.904 89.101-22.276 61.462-47.524 131.124-56.135 144.625-10.091 15.824-96.974 73.499-138.295 100.01l0.158-70.079-16.909 60.519c-26.589-12.614-145.036-69.984-183.221-108.579-33.31-33.668-69.46-70.678-69.821-71.047l-8.025-8.217-1.169 24.543c-20.741-25.362-73.81-96.461-69.047-154.564 4.252-51.882 26.298-115.955 107.173-126.562a144.664 144.664 0 0 1 18.729-1.226c43.991 0 88.267 20.151 131.597 59.892 42.345 38.839 73.5 86.785 92.179 120.169l9.363 16.734V633.23c0-34.394 29.48-59.342 57.989-83.468 24.81-20.996 50.464-42.706 57.062-71.017 4.539-19.471 7.164-40.087 9.48-58.276 3.935-30.9 7.651-60.086 19.198-67.24 9.766-6.049 19.432-9.116 28.729-9.116 30.847 0 58.551 34.536 70.581 87.984 2.455 10.908 3.495 26.752 4.413 40.731 0.434 6.591 0.81 11.932 1.213 16.272-1.009-0.901-1.948-1.567-2.952-2.016z"
            fill="#000" p-id="3900" />
        </svg>
        <div>
          <el-input placeholder="Hobby" v-model="Hobby"></el-input>
        </div>
      </div>

      <div>
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665843037328"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="3504" width="20" height="20">
          <path
            d="M824.8 613.2c-16-51.4-34.4-94.6-62.7-165.3C766.5 262.2 689.3 112 511.5 112 331.7 112 256.2 265.2 261 447.9c-28.4 70.8-46.7 113.7-62.7 165.3-34 109.5-23 154.8-14.6 155.8 18 2.2 70.1-82.4 70.1-82.4 0 49 25.2 112.9 79.8 159-26.4 8.1-85.7 29.9-71.6 53.8 11.4 19.3 196.2 12.3 249.5 6.3 53.3 6 238.1 13 249.5-6.3 14.1-23.8-45.3-45.7-71.6-53.8 54.6-46.2 79.8-110.1 79.8-159 0 0 52.1 84.6 70.1 82.4 8.5-1.1 19.5-46.4-14.5-155.8z"
            p-id="3505" />
        </svg>
        <div>
          <el-input placeholder="QQ" v-model="QQ"></el-input>
        </div>
      </div>

      <div>
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665843401962"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="5024" width="20" height="20">
          <path
            d="M269.984323 407.981253c85.14198 124.436687 219.017051 254.717414 343.453738 333.306828 19.533576-15.623758 51.479273-45.23701 95.831919-88.829414a34.133333 34.133333 0 0 1 37.174303-7.111111l196.659717 82.799191a34.133333 34.133333 0 0 1 18.313051 44.456081l-78.796283 191.363879c-6.547394 0-13.09996 0-13.09996-6.547394v6.547394C476.558222 852.62998 168.225616 547.902061 56.888889 161.486869a33.559273 33.559273 0 0 1 21.121293-31.164768l177.508848-70.852525a34.133333 34.133333 0 0 1 44.109576 18.46303L381.248646 271.773737a34.133333 34.133333 0 0 1-10.322747 40.049778c-51.789576 40.841051-85.436768 72.890182-100.941576 96.152566z"
            p-id="5025" fill="#2c2c2c" />
        </svg>
        <div>
          <el-input placeholder="Telephone" v-model="Telephone"></el-input>
        </div>
      </div>

      <div>
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665898641938"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="2092" width="20" height="20">
          <path
            d="M513.04903111 939.34705778c-2.47011555 0-4.94023111-0.30833778-7.35232-0.92046223-3.74556445-0.95573333-92.62990222-24.10496-182.38236444-87.0957511-121.22680889-85.08074667-185.30645333-202.06592-185.30645334-338.28864V212.73031111a29.72672 29.72672 0 0 1 29.72672-29.72672c161.90008889 0 328.99640889-93.56174222 330.66325334-94.50609778a29.69258667 29.69258667 0 0 1 29.56401778 0.15701334c1.61336889 0.93297778 164.96412445 94.34908445 328.29781333 94.34908444a29.72672 29.72672 0 0 1 29.72672 29.72672v300.31189334c0 135.41262222-63.67800889 252.12472889-184.14136889 337.51381333-89.19950222 63.22972445-177.54794667 86.84544-181.25937778 87.81824-2.46897778 0.65194667-5.00849778 0.9728-7.53664 0.9728zM197.46133333 241.56615111v271.47605334c0 117.10919111 53.34926222 214.20714667 158.55616 288.61553777 66.78300445 47.22005333 134.74133333 70.27712 156.92458667 77.01731556 22.08426667-6.86193778 89.60682667-30.24554667 155.95861333-77.63512889 104.59591111-74.69966222 157.63569778-171.59395555 157.63569778-287.99772444V241.58435555c-140.56106667-8.10894222-270.57265778-70.67420445-313.64664889-93.41724444-43.60874667 22.57351111-175.94481778 85.20817778-315.42840889 93.40017778z"
            fill="#2c2c2c" p-id="2093" />
          <path
            d="M484.352 662.59854222a29.63342222 29.63342222 0 0 1-21.01703111-8.70286222L328.92472889 519.49112889a29.72672 29.72672 0 0 1 42.03633778-42.04088889l113.39093333 113.39093333 196.43960889-196.45098666a29.72672 29.72672 0 0 1 42.04202666 42.03633778L505.37699555 653.89568a29.65048889 29.65048889 0 0 1-21.02499555 8.704z"
            fill="#2c2c2c" p-id="2094" />
        </svg>
        <el-input placeholder="修改邮箱时需要提供验证码" v-model="Verify"></el-input>
      </div>

      <div>
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665843569561"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="6028" width="20" height="20">
          <path
            d="M306.622958 619.694791c125.358079-17.374716 221.908042-124.919081 221.908042-255.04986 0-142.28868-115.312282-257.599939-257.607102-257.599939C128.686383 107.043968 13.323958 222.35625 13.323958 364.644931c0 130.130779 96.543823 237.675144 221.961254 255.04986l0 124.025735L68.450487 743.720525l0 71.228251 166.834726 0 0 166.885891 71.285556 0L306.570769 815.001989l166.828586 0 0-71.230298L306.622958 743.771691 306.622958 619.694791 306.622958 619.694791zM84.720032 364.644931c0-102.930277 83.333964-186.262194 186.203866-186.262194 102.929254 0 186.262194 83.389222 186.262194 186.262194 0 102.875019-83.33294 186.262194-186.262194 186.262194C168.053995 550.906102 84.720032 467.519949 84.720032 364.644931L84.720032 364.644931zM84.720032 364.644931M504.102634 757.319242c0.051165 142.295843 115.420753 257.606079 257.768785 257.548774 142.28868-0.058328 257.542634-115.421776 257.490445-257.710456-0.058328-130.137942-96.66048-237.616816-222.018559-254.992555l-0.109494-261.377986 68.122517 68.174706 50.411133-50.411133L797.123294 140.018987l0 0 0 0L761.425258 104.377232 607.361393 258.602779l50.41011 50.358945 68.175729-68.235081 0.115634 261.380032C600.588129 519.592932 504.044306 627.185392 504.102634 757.319242L504.102634 757.319242zM947.964768 757.157559c0.109494 102.929254-83.274612 186.31336-186.211029 186.371688-102.928231 0.052189-186.262194-83.331917-186.31336-186.210006 0-102.870926 83.275635-186.261171 186.203866-186.31336C864.522334 570.896388 947.907463 654.28254 947.964768 757.157559L947.964768 757.157559zM947.964768 757.157559"
            p-id="6029" />
        </svg>
        <el-radio v-model="Sex" :label="false" style="margin-left: 1rem;">男</el-radio>
        <el-radio v-model="Sex" :label="true">女</el-radio>
      </div>

      <div>
        <div @click="upbatePerMsg">Save</div>
        <div @click="getVerifyCode">发送验证码</div>
        <div @click="editFlag = false">Cancel</div>
      </div>
    </div>

    <div v-else>
      <div class="Name">{{ Name }}</div>
      <div class="edit" @click="editFlag = true">Edit profile</div>
      <div class="Email" v-if="Address">
        <svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
          <path fill-rule="evenodd"
            d="M11.536 3.464a5 5 0 010 7.072L8 14.07l-3.536-3.535a5 5 0 117.072-7.072v.001zm1.06 8.132a6.5 6.5 0 10-9.192 0l3.535 3.536a1.5 1.5 0 002.122 0l3.535-3.536zM8 9a2 2 0 100-4 2 2 0 000 4z">
          </path>
        </svg>
        <span>{{ Address }}</span>
      </div>

      <div class="Email" v-if="Email">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665840042361"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="2544" width="20" height="20">
          <path
            d="M874.666667 375.189333V746.666667a64 64 0 0 1-64 64H213.333333a64 64 0 0 1-64-64V375.189333l64 54.250667V746.666667h597.333334V429.44l64-54.250667zM810.666667 213.333333a64.789333 64.789333 0 0 1 22.826666 4.181334 63.616 63.616 0 0 1 26.794667 19.413333 64.32 64.32 0 0 1 9.344 15.466667c2.773333 6.570667 4.48 13.696 4.906667 21.184L874.666667 277.333333v21.333334L553.536 572.586667a64 64 0 0 1-79.893333 2.538666l-3.178667-2.56L149.333333 298.666667v-21.333334a63.786667 63.786667 0 0 1 35.136-57.130666A63.872 63.872 0 0 1 213.333333 213.333333h597.333334z m-9.6 64h-578.133334L512 523.882667 801.066667 277.333333z"
            p-id="2545" />
        </svg>
        <span>{{ Email }}</span>
      </div>

      <div class="Email" v-if="Hobby">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665843209019"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="3899" width="22" height="22">
          <path
            d="M771.616 503.798c2.176 2.021 4.392 3.535 6.839 3.837l12.339 1.522-7.739-9.506c-1.422-2.823-2.318-16.482-3.041-27.477-0.941-14.344-2.009-30.602-4.636-42.272-6.038-26.828-16.197-49.977-29.378-66.946-7.159-9.217-15.027-16.305-23.379-21.151-7.762-10.119-26.715-25.858-31.931-26.946-5.083-1.06-15.044 2.573-19.978 5.958-7.348-6.753-15.332-13.002-19.488-12.54-4.588 0.51-11.2 4.658-15.054 8.533-31.478-78.994-53.626-108.336-104.876-133.431a21.45 21.45 0 0 0 7.311-3.173c7.309-4.952 11.752-11.386 13.206-19.125 2.026-10.785-1.849-23.363-11.519-37.383-8.242-11.95-19.426-18.531-31.49-18.531-7.104 0-14.073 2.313-20.154 6.69-2.517 1.812-4.809 4.129-6.891 6.98a33.615 33.615 0 0 0-1.948-4.29c-2.594-4.792-8.06-10.503-19.366-10.503-8.579 0-19.537 3.366-32.567 10.006-15.55 7.923-24.961 19.081-25.822 30.612-0.587 7.872 2.973 14.98 10.025 20.017 0.292 0.208 0.587 0.416 0.885 0.621-7.735 2.512-16.689 6.918-21.82 14.516-4.031 5.97-5.104 12.858-3.187 20.473 5.035 20.01 25.733 36.915 45.197 36.915 0.874 0 1.749-0.035 2.601-0.104 8.585-0.694 13.815-3.873 17.376-8.387 1.095 2.526 2.528 4.813 4.286 6.804 4.815 5.453 11.681 8.336 19.855 8.336 7.579 0 16.051-2.464 25.181-7.324 26.65-14.184 32.266-28.321 32.285-37.682a23.562 23.562 0 0 0-0.174-2.875c49.204 29.338 83.479 83.419 103.896 170.933 2.541 1.42 5.744 0.746 8.362-0.978-1.567 4.68-2.875 9.922-4.023 15.639-20.258-13.446-11.28-34.159-14.207-36.702-3.19-2.771-11.404 12.466-6.231 32.871 2.001 7.893 10.442 21.877 16.614 27.736-0.596 4.434-1.181 9.018-1.782 13.735-2.397 18.828-4.877 38.297-9.299 57.27-5.848 25.085-29.132 44.79-53.784 65.652-26.023 22.023-52.809 44.689-59.785 75.444-19.43-32.724-48.546-74.604-86.527-109.439-45.233-41.487-91.783-62.523-138.356-62.523-6.658 0-13.396 0.441-20.03 1.311-36.631 4.805-65.279 20.393-85.149 46.332-17.364 22.667-27.69 52.722-30.69 89.33-2.631 32.094 10.039 70.793 37.656 115.022 20.375 32.63 41.172 55.654 42.048 56.619l8.121 8.945 1.254-26.339c12.57 12.844 37.936 38.725 61.842 62.887 44.155 44.629 185.458 110.35 191.452 113.126l5.334 2.471 0.286-1.023-0.033 14.779 7.7-4.888c13.792-8.754 135.143-86.155 149.068-107.991 9.204-14.432 33.555-81.619 57.104-146.595 12.493-34.469 24.293-67.026 32.819-88.871 1.464-3.752 2.72-6.691 3.828-9.284 3.223-7.544 5.109-11.96 6.08-22.297 3.559 3.624 4.997 4.574 6.718 4.932l8.461 1.758-2.693-8.212c-1.881-5.731-0.621-22.085 0.299-34.026 0.297-3.861 0.533-7.084 0.699-9.798z m-273.86-276.096c-7.669 4.081-14.56 6.151-20.483 6.151-5.298 0-9.456-1.667-12.359-4.955-3.578-4.053-5.037-10.388-4.107-17.838a5 5 0 0 0-9.729-2.128c-4.378 13.83-6.534 17.424-16.129 18.199-0.585 0.047-1.189 0.071-1.795 0.071-13.297 0-31.146-12.056-35.5-29.355-1.209-4.806-0.628-8.874 1.777-12.436 5.129-7.597 17.684-11.776 27.722-13.155a5 5 0 0 0 1.522-9.443c-4.358-2.138-7.785-4.132-10.785-6.274-4.218-3.013-6.191-6.759-5.865-11.135 0.585-7.848 8.208-16.239 20.39-22.446 11.611-5.917 21.041-8.916 28.027-8.916 6.922 0 9.349 3.004 10.572 5.264 2.699 4.985 3.496 10.802 2.367 17.291a5 5 0 0 0 9.681 2.402c3.04-9.356 6.884-15.758 11.427-19.028 4.369-3.145 9.318-4.807 14.312-4.807 8.678 0 16.938 5.046 23.257 14.209 7.986 11.579 11.418 21.904 9.923 29.859-0.957 5.092-3.896 9.244-8.987 12.692-2.017 1.367-4.274 2.031-6.899 2.031h-0.001c-3.697 0-7.459-1.334-10.205-2.309-1.108-0.393-2.065-0.732-2.959-0.977a4.996 4.996 0 0 0-5.961 2.97 5 5 0 0 0 2.277 6.258c7.077 3.802 15.51 10.172 15.493 18.928-0.018 9.371-9.6 19.626-26.983 28.877z m190.636 100.023c1.403 0.758 3.818 3.512 6.111 6.399a54.611 54.611 0 0 0-9.431 0.93c-1.88-1.939-5.179-5.393-9.065-9.201 3.74-0.25 8.172-0.405 12.385 1.872z m-37.545 27.467c-4.272-11.528-8.319-22.208-12.215-32.146 3.412-1.127 7.833-2.991 12.821-0.296 2.765 1.494 12.275 14.878 15.07 18.867a84.21 84.21 0 0 0-5.477 3.112c-4.018 2.489-7.239 6.244-9.891 11.053-0.09-0.2-0.192-0.396-0.308-0.59z m117.447 131.892l-15.424-6.89 8.901 13.731c0.435 2.538-0.262 11.582-0.825 18.901-0.697 9.05-1.243 16.894-1.303 23.346-1.62-1.737-2.291-2.414-2.92-2.87l-7.653-5.55-0.28 9.449c-0.522 17.645-1.886 20.836-5.934 30.31-1.137 2.661-2.426 5.678-3.948 9.576-8.57 21.959-20.391 54.572-32.904 89.101-22.276 61.462-47.524 131.124-56.135 144.625-10.091 15.824-96.974 73.499-138.295 100.01l0.158-70.079-16.909 60.519c-26.589-12.614-145.036-69.984-183.221-108.579-33.31-33.668-69.46-70.678-69.821-71.047l-8.025-8.217-1.169 24.543c-20.741-25.362-73.81-96.461-69.047-154.564 4.252-51.882 26.298-115.955 107.173-126.562a144.664 144.664 0 0 1 18.729-1.226c43.991 0 88.267 20.151 131.597 59.892 42.345 38.839 73.5 86.785 92.179 120.169l9.363 16.734V633.23c0-34.394 29.48-59.342 57.989-83.468 24.81-20.996 50.464-42.706 57.062-71.017 4.539-19.471 7.164-40.087 9.48-58.276 3.935-30.9 7.651-60.086 19.198-67.24 9.766-6.049 19.432-9.116 28.729-9.116 30.847 0 58.551 34.536 70.581 87.984 2.455 10.908 3.495 26.752 4.413 40.731 0.434 6.591 0.81 11.932 1.213 16.272-1.009-0.901-1.948-1.567-2.952-2.016z"
            fill="#000" p-id="3900" />
        </svg>
        <span>{{ Hobby }}</span>
      </div>

      <div class="Email" v-if="QQ">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665843037328"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="3504" width="20" height="20">
          <path
            d="M824.8 613.2c-16-51.4-34.4-94.6-62.7-165.3C766.5 262.2 689.3 112 511.5 112 331.7 112 256.2 265.2 261 447.9c-28.4 70.8-46.7 113.7-62.7 165.3-34 109.5-23 154.8-14.6 155.8 18 2.2 70.1-82.4 70.1-82.4 0 49 25.2 112.9 79.8 159-26.4 8.1-85.7 29.9-71.6 53.8 11.4 19.3 196.2 12.3 249.5 6.3 53.3 6 238.1 13 249.5-6.3 14.1-23.8-45.3-45.7-71.6-53.8 54.6-46.2 79.8-110.1 79.8-159 0 0 52.1 84.6 70.1 82.4 8.5-1.1 19.5-46.4-14.5-155.8z"
            p-id="3505" />
        </svg>
        <span>{{ QQ }}</span>
      </div>

      <div class="Email" v-if="Telephone">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665843401962"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="5024" width="20" height="20">
          <path
            d="M269.984323 407.981253c85.14198 124.436687 219.017051 254.717414 343.453738 333.306828 19.533576-15.623758 51.479273-45.23701 95.831919-88.829414a34.133333 34.133333 0 0 1 37.174303-7.111111l196.659717 82.799191a34.133333 34.133333 0 0 1 18.313051 44.456081l-78.796283 191.363879c-6.547394 0-13.09996 0-13.09996-6.547394v6.547394C476.558222 852.62998 168.225616 547.902061 56.888889 161.486869a33.559273 33.559273 0 0 1 21.121293-31.164768l177.508848-70.852525a34.133333 34.133333 0 0 1 44.109576 18.46303L381.248646 271.773737a34.133333 34.133333 0 0 1-10.322747 40.049778c-51.789576 40.841051-85.436768 72.890182-100.941576 96.152566z"
            p-id="5025" fill="#2c2c2c" />
        </svg>
        <span>{{ Telephone }}</span>
      </div>

      <div class="Email">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t="1665843569561"
          class="icon" viewBox="0 0 1024 1024" version="1.1" p-id="6028" width="20" height="20">
          <path
            d="M306.622958 619.694791c125.358079-17.374716 221.908042-124.919081 221.908042-255.04986 0-142.28868-115.312282-257.599939-257.607102-257.599939C128.686383 107.043968 13.323958 222.35625 13.323958 364.644931c0 130.130779 96.543823 237.675144 221.961254 255.04986l0 124.025735L68.450487 743.720525l0 71.228251 166.834726 0 0 166.885891 71.285556 0L306.570769 815.001989l166.828586 0 0-71.230298L306.622958 743.771691 306.622958 619.694791 306.622958 619.694791zM84.720032 364.644931c0-102.930277 83.333964-186.262194 186.203866-186.262194 102.929254 0 186.262194 83.389222 186.262194 186.262194 0 102.875019-83.33294 186.262194-186.262194 186.262194C168.053995 550.906102 84.720032 467.519949 84.720032 364.644931L84.720032 364.644931zM84.720032 364.644931M504.102634 757.319242c0.051165 142.295843 115.420753 257.606079 257.768785 257.548774 142.28868-0.058328 257.542634-115.421776 257.490445-257.710456-0.058328-130.137942-96.66048-237.616816-222.018559-254.992555l-0.109494-261.377986 68.122517 68.174706 50.411133-50.411133L797.123294 140.018987l0 0 0 0L761.425258 104.377232 607.361393 258.602779l50.41011 50.358945 68.175729-68.235081 0.115634 261.380032C600.588129 519.592932 504.044306 627.185392 504.102634 757.319242L504.102634 757.319242zM947.964768 757.157559c0.109494 102.929254-83.274612 186.31336-186.211029 186.371688-102.928231 0.052189-186.262194-83.331917-186.31336-186.210006 0-102.870926 83.275635-186.261171 186.203866-186.31336C864.522334 570.896388 947.907463 654.28254 947.964768 757.157559L947.964768 757.157559zM947.964768 757.157559"
            p-id="6029" />
        </svg>
        <el-radio v-model="Sex" :label="false" style="margin-left: 1rem;">男</el-radio>
        <el-radio v-model="Sex" :label="true">女</el-radio>
      </div>
    </div>

    <el-dialog title="修改头像" :visible.sync="editAvatarFlag" width="40%">
      <el-row type="flex" justify="center">
        <div class="cropper">
          <vueCropper ref="cropper" :img="option.img" :outputSize="option.size" :outputType="option.outputType"
            :info="option.info" :full="option.full" :canMove="option.canMove" :canMoveBox="option.canMoveBox"
            :original="option.original" :autoCrop="option.autoCrop" :autoCropWidth="option.autoCropWidth"
            :autoCropHeight="option.autoCropHeight" :fixedBox="option.fixedBox" @realTime="realTime"></vueCropper>
        </div>
        <div class="previewBox">
          <div :style="previews.div" class="preview">
            <img :src="previews.url" :style="previews.img">
          </div>
          <el-row type="flex" justify="center">
            <el-upload action="" :show-file-list="false" :auto-upload="false" :on-change="uploadImg">
              <el-button size="mini" type="primary"> 更换头像
              </el-button>
            </el-upload>
          </el-row>
          <br>
          <el-row>
            <el-button icon="el-icon-plus" circle size="mini" @click="changeScale(1)"></el-button>
            <el-button icon="el-icon-minus" circle size="mini" @click="changeScale(-1)"></el-button>
            <el-button icon="el-icon-download" circle size="mini" @click="down('blob')"></el-button>
            <el-button icon="el-icon-refresh-left" circle size="mini" @click="rotateLeft"></el-button>
            <el-button icon="el-icon-refresh-right" circle size="mini" @click="rotateRight"></el-button>
          </el-row>
        </div>
      </el-row>
      <span slot="footer" class="dialog-footer">
        <el-button @click="editAvatarFlag = false">取 消</el-button>
        <el-button type="primary" @click="saveEditAvatar">确 定</el-button>
      </span>
    </el-dialog>
  </div>
</template>

<script>
import { getUserMsg } from '@/api/user.js'
import { upbateUser } from '@/api/user.js'
import { upbateAvatar } from '@/api/user.js'
import { getcode } from '@/api/login.js'
import { VueCropper } from 'vue-cropper'
export default {
  data() {
    return {
      editFlag: false,
      imgurl: '',
      Name: '',
      Address: '',
      Email: '',
      Hobby: '',
      QQ: '',
      Sex: '',
      Telephone: '',
      Verify: '',
      flag: true,
      editAvatarFlag: false,
      userForm: {
        Newname: '',
        Newblog: '',
        Newqq: '',
        Newsex: '',
        Newemail: '',
        Newaddress: '',
        Newtelephone: '',
        Newhobby: '',
      },
      // require("@/assets/images/1.jpg")
      avatarURL: '',
      editAvatarDialog: true,
      previews: {},
      option: {
        img: '', // 裁剪图片的地址
        info: true, // 裁剪框的大小信息
        outputSize: 1, // 剪切后的图片质量（0.1-1）
        full: true, // 输出原图比例截图 props名full
        outputType: 'png', // 裁剪生成额图片的格式
        canMove: true,  // 能否拖动图片
        original: false,  // 上传图片是否显示原始宽高
        canMoveBox: true,  // 能否拖动截图框
        autoCrop: true, // 是否默认生成截图框
        autoCropWidth: 150,
        autoCropHeight: 150,
        fixedBox: true // 截图框固定大小
      },
    }
  },
  mounted() {
    this.GetUserMsg()
  },
  components: {
    VueCropper
  },
  methods: {
    async GetUserMsg() {
      const res = await getUserMsg()
      this.$store.commit('changeUser', res.data.user)
      this.imgurl = this.$store.state.baseurl + res.data.user.Icon
      this.Name = res.data.user.Name
      this.Email = res.data.user.Email
      this.Hobby = res.data.user.Hobby
      this.QQ = res.data.user.QQ
      this.Sex = res.data.user.Sex
      this.Telephone = res.data.user.Telephone
      this.Address = res.data.user.Address
    },

    async upbatePerMsg() {
      let userForm = {
        Newname: this.Name,
        Newqq: this.QQ,
        Newsex: this.Sex,
        Newaddress: this.Address,
        Newtelephone: this.Telephone,
        Newhobby: this.Hobby,
        Newemail: this.Email,
        Verify: this.Verify
      }
      await upbateUser(userForm)
      this.GetUserMsg()
      setTimeout(() => {
        this.editFlag = false
      }, 800);
    },

    async getVerifyCode() {
      if (!this.flag) return this.$message.error('请等待三十秒再发送验证码')
      this.codeNum = 30
      this.flag = false
      this.getTime()
      // 检验邮箱之后再发验证码
      const regEmail = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/
      if (!regEmail.test(this.Email)) {
        return this.$message.error('该邮箱格式不正确！')
      }
      const res = await getcode(this.Email)
      if (res.code !== 200) return this.$message.error(res.msg)
      if (res.code === 200) return this.$message.success(res.msg)
    },

    getTime() {
      this.timer && clearTimeout(this.timer)
      // 新增代码：
      const now = Date.now();
      const diffTime = Math.floor((now - this.curTime) / 1000);
      this.curTime = now;
      this.codeNum -= diffTime
      if (this.codeNum < 0) return this.flag = true
      this.timer = setTimeout(() => {
        this.getTime();
      }, 1000)
    },

    // 保存头像修改
    saveEditAvatar() {
      this.editAvatarFlag = false
      this.finish('blob')
    },
    // 放大/缩小
    changeScale(num) {
      num = num || 1;
      this.$refs.cropper.changeScale(num);
    },
    // 左旋转
    rotateLeft() {
      this.$refs.cropper.rotateLeft();
    },
    // 右旋转
    rotateRight() {
      this.$refs.cropper.rotateRight();
    },
    // 保存上传图片
    finish(type) {
      if (type === 'blob') {
        this.$nextTick(this.$refs.cropper.getCropBlob(async (data) => {
          let mf = new FormData()
          //将图片文件放入mf
          mf.append('file', data, "DX.jpg")
          let res = await upbateAvatar(mf)
          if (res.code === 200) {
            window.location.reload()
            this.$message.success(res.msg)
          } else return this.$message.error(res.msg)
        }))
      } else {
        this.$refs.cropper.getCropData(async (data) => {
          let mf = new FormData()
          //将图片文件放入mf
          mf.append('file', data, "DX.jpg")
          let res = await upbateAvatar(mf)
          if (res.code === 200) {
            window.location.reload()
            this.$message.success(res.msg)
          } else return this.$message.error(res.msg)
        })
      }
    },
    // 实时预览函数
    realTime(data) {
      this.previews = data
    },
    // 下载图片
    down(type) {
      var aLink = document.createElement('a')
      aLink.download = 'author-img'
      if (type === 'blob') {
        this.$refs.cropper.getCropBlob((data) => {
          aLink.href = window.URL.createObjectURL(data)
          aLink.click()
        })
      } else {
        this.$refs.cropper.getCropData((data) => {
          aLink.href = data;
          aLink.click()
        })
      }
    },
    // 更换头像--上传本地图片
    uploadImg(file) {
      const isJPG = file.raw.type == 'image/jpeg' || file.raw.type == 'image/png' || file.raw.type == 'image/gif'
      const isLt2M = file.size / 1024 / 1024 < 2
      if (!isJPG) {
        return this.$message.error('上传图片只能是 JPG 或 PNG 或 jpeg 格式!')
      }
      if (!isLt2M) {
        return this.$message.error('上传图片大小不能超过 2MB!')
      }
      var _this = this;
      var reader = new FileReader();
      reader.onload = (e) => {
        let data;
        if (typeof e.target.result === 'object') {
          // 把Array Buffer转化为blob 如果是base64不需要
          data = window.URL.createObjectURL(new Blob([e.target.result]))
        } else {
          data = e.target.result
        }
        _this.option.img = data
      }
      // 转化为base64
      // reader.readAsDataURL(file.raw)
      // 转化为blob
      reader.readAsArrayBuffer(file.raw)
    },
  }
}
</script>

<style lang="scss" scoped>

.personMsg {
  min-width: 16rem;
  width: 16rem;
  height: 18rem;
  margin: 0 3rem 0 12rem;
  position: relative;

  >div:first-child {
    height: 18rem;
    margin-bottom: 1rem;

    img {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      cursor: pointer;
    }

    div {
      position: absolute;
      bottom: -2.4rem;
      left: 4rem;
      width: 10rem;
      height: 2rem;
      border-radius: 2rem;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #000;
      color: #F6F8FA;
      font-size: .8rem;
      transition: all .5s linear;
      opacity: 0;
      cursor: pointer;
    }

    div::before {
      content: "";
      display: block;
      position: absolute;
      left: 4.3rem;
      top: -20px;
      border-width: 10px;
      border-style: dashed solid dashed dashed;
      border-color: transparent transparent black transparent;
    }
  }

  >div:first-child:hover div {
    opacity: .8;
  }

}

.Name {
  color: gray;
  margin-top: .5rem;
}

.edit {
  height: 2rem;
  margin: 1rem 0 1rem 0;
  background-color: #F6F8FA;
  text-align: center;
  line-height: 2rem;
  cursor: pointer;
  border-radius: 16px;
  box-shadow: rgba(99, 99, 99, 0.2) 0px 2px 8px 0px;
  transition: all .3s linear;
}

.edit:hover {
  background-color: #F6F8FA;
}


.Email {
  display: flex;
  align-items: center;
  height: 2rem;

  span {
    margin-left: 1rem;
  }
}

.editPMsg {

  >div:nth-child(-n+7) {
    display: flex;
    align-items: center;
    margin-top: .5rem;
    justify-content: space-between;

    >div {
      width: 90%;
      text-align: center;
    }
  }

  >div:last-child {
    display: flex;
    align-items: center;
    margin-top: 1rem;
    font-size: .75rem;

    >div:first-child {
      width: 3rem;
      height: 2rem;
      background-color: #2DA44E;
      color: white;
      text-align: center;
      line-height: 2rem;
      border-radius: 20%;
      cursor: pointer;
      margin-right: .5rem;
      transition: all .2s linear;
    }

    >div:hover {
      filter: alpha(Opacity=80);
      -moz-opacity: 0.8;
      opacity: 0.8;
    }

    >div:nth-child(2) {
      width: 6rem;
      height: 2rem;
      text-align: center;
      line-height: 2rem;
      box-shadow: rgba(99, 99, 99, 0.2) 0px 2px 8px 0px;
      cursor: pointer;
      margin: 0 1rem;
    }

    >div:last-child {
      width: 3rem;
      height: 2rem;
      text-align: center;
      line-height: 2rem;
      box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
      border-radius: 20%;
      background-color: #F6F8FA;
      cursor: pointer;
    }
  }
}

.previewBox {
  text-align: center;
  margin-left: 60px;
}

.preview {
  width: 150px;
  height: 150px;
  margin: 0px auto 20px auto;
  border-radius: 50%;
  border: 1px solid #ccc;
  background-color: #ccc;
  overflow: hidden;
}

.cropper {
  width: 260px;
  height: 260px;
}
</style>